<!doctype html><html dir=ltr lang=en data-theme class=html><head><title>Implementing the Sieve of Eratosthenes in Elixir |
I'm Andreas Wachs</title><meta charset=utf-8><meta name=generator content="Hugo 0.96.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content="I'm Andreas Wachs"><meta name=description content="
      A showcase of an implementation of the Sieve of Eratosthenes in Elixir


    "><link rel=stylesheet href=/scss/main.min.5551757e3608c8c17519a404d0c78646f8b4ce68b04e5acc290a21597ce09467.css integrity="sha256-VVF1fjYIyMF1GaQE0MeGRvi0zmiwTlrMKQohWXzglGc=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.31b0a1f317f55c529a460897848c97436bb138b19c399b37de70d463a8bf6ed5.css integrity="sha256-MbCh8xf1XFKaRgiXhIyXQ2uxOLGcOZs33nDUY6i/btU=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.69685904d5c2a0c6258d03c207b778c10466edf6cea928cc0164c376b0ad0930.css integrity="sha256-aWhZBNXCoMYljQPCB7d4wQRm7fbOqSjMAWTDdrCtCTA=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.6d585e78d28cce1200d39fb133c92ed83df01738da721d0f48fb6eac62d24e04.css integrity="sha256-bVheeNKMzhIA05+xM8ku2D3wFzjach0PSPturGLSTgQ=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.6b00d96498d59caa0dbcf9b49d30d821915291f2ceb0e19248523c8607ff43fa.css integrity="sha256-awDZZJjVnKoNvPm0nTDYIZFSkfLOsOGSSFI8hgf/Q/o=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=canonical href=https://example.com/post/sieve-of-erastosthenes-elixir/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.560a26330d27ff44a44e83b53cd07a95d4230a65930d31c5c76a8d481e5b35bf.js integrity="sha256-VgomMw0n/0SkToO1PNB6ldQjCmWTDTHFx2qNSB5bNb8=" crossorigin=anonymous></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://example.com/images/site-feature-image.png"><meta name=twitter:title content="Implementing the Sieve of Eratosthenes in Elixir"><meta name=twitter:description content="A showcase of an implementation of the Sieve of Eratosthenes in Elixir"><meta property="og:title" content="Implementing the Sieve of Eratosthenes in Elixir"><meta property="og:description" content="A showcase of an implementation of the Sieve of Eratosthenes in Elixir"><meta property="og:type" content="article"><meta property="og:url" content="https://example.com/post/sieve-of-erastosthenes-elixir/"><meta property="og:image" content="https://example.com/images/site-feature-image.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-09T00:00:00+00:00"><meta property="article:modified_time" content="2021-05-09T00:00:00+00:00"><meta property="og:site_name" content="IO.puts(webpage)"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"post","name":"Implementing the Sieve of Eratosthenes in Elixir","headline":"Implementing the Sieve of Eratosthenes in Elixir","alternativeHeadline":"","description":"
      A showcase of an implementation of the Sieve of Eratosthenes in Elixir


    ","inLanguage":"en","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/example.com\/post\/sieve-of-erastosthenes-elixir\/"},"author":{"@type":"Person","name":"Andreas Wachs"},"creator":{"@type":"Person","name":"Andreas Wachs"},"accountablePerson":{"@type":"Person","name":"Andreas Wachs"},"copyrightHolder":{"@type":"Person","name":"Andreas Wachs"},"copyrightYear":"2021","dateCreated":"2021-05-09T00:00:00.00Z","datePublished":"2021-05-09T00:00:00.00Z","dateModified":"2021-05-09T00:00:00.00Z","publisher":{"@type":"Organization","name":"Andreas Wachs","url":"https://example.com","logo":{"@type":"ImageObject","url":"https:\/\/example.com\/favicons\/favicon-32x32.png","width":"32","height":"32"}},"image":["https://example.com/images/site-feature-image.png"],"url":"https:\/\/example.com\/post\/sieve-of-erastosthenes-elixir\/","wordCount":"1414","genre":[],"keywords":["elixir","algorithms"]}</script></head><body class="body theme--light"><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
."><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src=/images/profile2.png alt="profile picture"><h1 class=sidebar__introduction-title><a href=/>IO.puts(webpage)</a></h1><div class=sidebar__introduction-description><p>Father & Nerd</p></div></div><ul class=sidebar__list><li class=sidebar__list-item><a href=https://www.linkedin.com/in/andreas-wachs/ rel=me aria-label=Linkedin title=Linkedin><i class="fab fa-linkedin fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://github.com/andreaswachs rel=me aria-label=GitHub title=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=mailto:andreas@wachs.dk rel=me aria-label=e-mail title=e-mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
2022</li><li class=footer__item><a class=link href=/imprint/ title>imprint</a></li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.a3fd0638ada4e3cec287e49a604b4a828cfef33a669afe60b96575761fff5cf3.js integrity="sha256-o/0GOK2k487Ch+SaYEtKgoz+8zpmmv5guWV1dh//XPM=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css integrity=sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js integrity=sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js integrity=sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v crossorigin=anonymous onload=renderMathInElement(document.body)></script></div></aside><main class=wrapper__main><header class=header><div class=.><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu><li class=nav__list-item><a href=/ title>Home</a></li><li class=nav__list-item><a href=/post/ title>Posts</a></li><li class=nav__list-item><a href=/portfolio/ title>Portfolio</a></li><li class=nav__list-item><a href=/about/ title>About</a></li><li class=nav__list-item><a href=/contact/ title>Contact</a></li></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
."><div class=post__content><h1>Implementing the Sieve of Eratosthenes in Elixir</h1><ul class=post__meta><li class=post__meta-item><em class="fas fa-calendar-day post__meta-icon"></em>
<span class=post__meta-text>5/9/2021</span></li><li class=post__meta-item><em class="fas fa-stopwatch post__meta-icon"></em>
<span class=post__meta-text>7-minute read</span></li></ul><h2 id=table-of-contents>Table of Contents</h2><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#quick-explanation-of-the-elixir-programming-language>Quick explanation of the Elixir programming language</a></li><li><a href=#sieve-of-eratosthenes-the-algorithm>Sieve of Eratosthenes: the algorithm</a></li><li><a href=#sieve-of-eratostenes-an-elixir-implementation>Sieve of Eratostenes: an Elixir implementation</a><ul><li><a href=#creating-a-fitting-api>Creating a fitting API</a></li><li><a href=#the-meat-of-the-algorithm>The meat of the algorithm</a></li><li><a href=#rounding-off>Rounding off</a></li><li><a href=#the-complete-source-code>The complete source code</a></li></ul></li></ul><h2 id=quick-explanation-of-the-elixir-programming-language>Quick explanation of the Elixir programming language</h2><p>Elixir is a dynamically typed, general-purpose programming language. The syntax of the Elixir programming language bears heavy influence from Ruby, Clojure and Erlang. It runs on the BEAM virtual machine, which is implemented in Erlang. As of this moment, spring 2021, the Elixir programming language has turned 10 years old. If you&rsquo;re interested, you should read the <a href=https://en.wikipedia.org/wiki/Elixir_(programming_language)>Wikipedia article</a> about the programming language to learn more.</p><h2 id=sieve-of-eratosthenes-the-algorithm>Sieve of Eratosthenes: the algorithm</h2><p><strong>Overview:</strong>
The Sieve of Eratosthenes is an algorithm for finding primes within a certain range. The algorithm only works if the range starts at $2$, but we can through programming provide users with the ability to give any arbitrary range, but we still need to do the work as if the user requested primes starting from a number larger than $2$.</p><p>The algorithm works by starting with a list of all the integers from 2 to a certain limit. It is known that $2$ is the first prime number, and it happens to be the first number in or list of numbers. We then remove all numbers that are multiples of two, which incidentally is all <a href=https://en.wikipedia.org/wiki/Composite_number>composite numbers</a>. When all the multiples of $2$ have been removed, we take the next number in the list, which must then also be a prime. We rinse and repeat this process until we have removed all the multiples of all the iteratively remaining numbers.</p><p>I can attempt to describe this in a more mathematical sense:</p><ol><li>We create a set containing distinct integers from $2$ to $n$, for some $n$ that the user inputs: $S = \lbrace x | x \in [2;n] \rbrace$ where $x$ is a positive integer.</li><li>We then (iteratively) transform the set such that we remove the smallest found prime number&rsquo;s multiples: $S&rsquo; = \lbrace x | x \in S \land \neg(s_0 | x) \rbrace$. Whilst doing this, we maintain another set of integers, the accumulated prime numbers $A$, where we after each iteration add $s_0$: $A = A \cup \lbrace s_0 \rbrace$. Furthermore, we need to remove the first element $s_0$ from $S$ such that the next first element will be the next prime number.</li><li>When we&rsquo;ve iterated over the entire set $S$, such that the set $S$ will become empty, we&rsquo;ve found all the primes that were to be found in that number range. The set accumulated prime set $A$ should then hold all the prime numbers in that rage.</li></ol><p>This is currently the best math-flavored explanation that I can give. If I&rsquo;m completely in the wrong feel free to contact me.</p><figure><img src=https://upload.wikimedia.org/wikipedia/commons/b/b9/Sieve_of_Eratosthenes_animation.gif alt=image><figcaption><p>By SKopp at German Wikipedia on the Sieve of Erastosthenes</p></figcaption></figure><h2 id=sieve-of-eratostenes-an-elixir-implementation>Sieve of Eratostenes: an Elixir implementation</h2><h3 id=creating-a-fitting-api>Creating a fitting API</h3><p>To start off; I would like to apply some <em>client-server</em> architecture to the implementation, such that clients of the API will only be able to make calls the the &ldquo;surface level&rdquo; functions, that provide numbers. All intermediate functions that helps in creating a list of primes is set <em>private</em> such that the user cannot hurt themselves.</p><p>I begin with defining the public API:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-elixir data-lang=elixir><span class=line><span class=cl><span class=kd>defmodule</span> <span class=nc>Primes</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>def</span> <span class=n>get</span><span class=p>(%{</span><span class=ss>from</span><span class=p>:</span> <span class=n>from</span><span class=p>,</span> <span class=ss>to</span><span class=p>:</span> <span class=n>to</span><span class=p>})</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>cond</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>      <span class=n>to</span> <span class=o>&gt;=</span> <span class=mi>2</span> <span class=ow>and</span> <span class=n>to</span> <span class=o>&gt;=</span> <span class=n>from</span> <span class=o>-&gt;</span> <span class=p>{</span><span class=ss>:ok</span><span class=p>,</span> <span class=n>sieve</span><span class=p>(</span><span class=n>from</span><span class=p>,</span> <span class=n>to</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>      <span class=n>to</span> <span class=o>&lt;</span> <span class=n>from</span> <span class=o>-&gt;</span> <span class=n>error</span><span class=p>(</span><span class=s2>&#34;Your upper bound is less than the lower bound.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>to</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=o>-&gt;</span> <span class=n>error</span><span class=p>(</span><span class=s2>&#34;There are no primes less than 2.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=no>true</span> <span class=o>-&gt;</span> <span class=n>error</span><span class=p>(</span><span class=s2>&#34;Uncaught error. Check your input.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Handle the case when only to: is given</span>
</span></span><span class=line><span class=cl>  <span class=kd>def</span> <span class=n>get</span><span class=p>(%{</span><span class=ss>to</span><span class=p>:</span> <span class=n>_to</span><span class=p>}</span> <span class=o>=</span> <span class=n>arg</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>get</span><span class=p>(</span><span class=nc>Map</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>arg</span><span class=p>,</span> <span class=ss>:from</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>def</span> <span class=n>get</span><span class=p>(%{</span><span class=ss>from</span><span class=p>:</span> <span class=n>_from</span><span class=p>})</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=c1># Handle the case when only from: is given</span>
</span></span><span class=line><span class=cl>    <span class=n>error</span><span class=p>(</span><span class=sx>~S(No &#34;to:&#34; value provided.)</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>defp</span> <span class=n>error</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=ss>:error</span><span class=p>,</span> <span class=n>msg</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></div><p>This code is not particularly interesting but it provides the client with a flexible API. Results will always be a tuple of an atom indicating either <code>:ok</code> or <code>:error</code>, such that the second value of the tuple can be correctly interpreted.</p><h3 id=the-meat-of-the-algorithm>The meat of the algorithm</h3><p>We can define the function <code>sieve/2</code> to take two lists as parameters: firstly, the list of numbers that is being worked on (set $S$ from before) and the accumulating list, where only primes numbers are added (set $A$ from before).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-elixir data-lang=elixir><span class=line><span class=cl><span class=kd>defp</span> <span class=n>sieve</span><span class=p>([</span><span class=n>n</span> <span class=o>|</span> <span class=n>ns</span><span class=p>],</span> <span class=n>acc</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>sieve</span><span class=p>(</span><span class=nc>Enum</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>ns</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=k>fn</span> <span class=n>x</span> <span class=o>-&gt;</span> <span class=n>rem</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span> <span class=k>end</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=n>n</span> <span class=o>|</span> <span class=n>acc</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>defp</span> <span class=n>sieve</span><span class=p>([],</span> <span class=n>acc</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>acc</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></div><p>By using the forever wonderful <code>Enum.filter/2</code> function, we can easily remove multiples of the first number. With some clever pattern matching, we can separate the first element of set $S$ and remove all multiples of that from the rest of the list.</p><p>The <code>sieve/2</code> function calls itself recursively. To prevent infinite recursive calls, we utilize pattern matching by the second definition of the <code>sieve/2</code> function, such that when $S$ is empty, the accumulated list is returned without any computation.</p><p>Since we allow the client to specify the range of witch they want primes returned within, we need to do a whole lot more work. For those who paid careful attention to the code before, they realize that we called <code>sieve/2</code> in the <code>get/1</code> function further above, but the parameters <code>from</code> and <code>to</code> were numbers. We have our intermediate <code>sieve/2</code> function for two numbers here:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-elixir data-lang=elixir><span class=line><span class=cl><span class=kd>defp</span> <span class=n>sieve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>when</span> <span class=n>is_number</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=ow>and</span> <span class=n>is_number</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nc>Enum</span><span class=o>.</span><span class=n>to_list</span><span class=p>(</span><span class=mi>2</span><span class=o>..</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=n>sieve</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nc>Enum</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=n>show_primes_in_range</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></div><p>We are now faced with the next interesting part of this implementation: prime numbers are pushed in front of the accumulated list. This is because it is the fastest insertion method, as opposed to add it to the end of the list. In the end, the list of prime numbers comes out in reverse order. This is what <code>Enum.reverse/1</code> takes care of.</p><p>We finish by ensuring that the client only is returned the prime numbers in the range that they requested. Here, we implement the <code>show-primes_in_range/2</code> function:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-elixir data-lang=elixir><span class=line><span class=cl><span class=kd>defp</span> <span class=n>show_primes_in_range</span><span class=p>([</span><span class=n>p</span> <span class=o>|</span> <span class=n>ps</span><span class=p>]</span> <span class=o>=</span> <span class=n>primes</span><span class=p>,</span> <span class=n>lower_bound</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=k>cond</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>lower_bound</span> <span class=o>==</span> <span class=mi>2</span> <span class=o>-&gt;</span> <span class=n>primes</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>&gt;=</span> <span class=n>lower_bound</span> <span class=o>-&gt;</span> <span class=n>primes</span>
</span></span><span class=line><span class=cl>    <span class=no>true</span> <span class=o>-&gt;</span> <span class=n>show_primes_in_range</span><span class=p>(</span><span class=n>ps</span><span class=p>,</span> <span class=n>lower_bound</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></div><p>Here, we throw away off the numbers, starting from the beginning of time primes list, if they are smaller than the lower bounds. When we reach a list of prime numbers where the first number is larger than the lower bound, we return that list. This is to ensure that the worst case running time is linear in the list of primes. If we were to resort something like <code>Enum.filter/2</code>, to filter out all values less than the lower bounds, we would be guaranteed to always have linear running time for this work.</p><h3 id=rounding-off>Rounding off</h3><p>Thank you for the read! As of writing, I&rsquo;ve just started learning about the Elixir programming language and are looking to work with it as a student software developer in a professional setting. I&rsquo;m trying to improve my learning by writing about what I&rsquo;ve practiced, to share what I&rsquo;ve made and trick myself into looking at the source code I&rsquo;ve produced multiple times, as a way to find better solutions and discover edge cases and bugs.</p><h3 id=the-complete-source-code>The complete source code</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-elixir data-lang=elixir><span class=line><span class=cl><span class=kd>defmodule</span> <span class=nc>Primes</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=na>@moduledoc</span> <span class=sh>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=sh>  This module provides an API (the get function) to
</span></span></span><span class=line><span class=cl><span class=sh>  efficiently generate lists of prime numbers.
</span></span></span><span class=line><span class=cl><span class=sh>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=na>@doc</span> <span class=sh>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=sh>  This is the client API for getting a list of primes
</span></span></span><span class=line><span class=cl><span class=sh>  The primes are found with the Sieve Of Eratosthenes algorithm
</span></span></span><span class=line><span class=cl><span class=sh>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>@spec</span> <span class=n>get</span><span class=p>(%{</span><span class=ss>:to</span> <span class=o>=&gt;</span> <span class=n>any</span><span class=p>,</span> <span class=n>optional</span><span class=p>(</span><span class=n>any</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=n>any</span><span class=p>})</span> <span class=o>::</span> <span class=p>{</span><span class=ss>:error</span><span class=p>,</span> <span class=p>[]}</span> <span class=o>|</span> <span class=p>{</span><span class=ss>:ok</span><span class=p>,</span> <span class=n>list</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>  <span class=kd>def</span> <span class=n>get</span><span class=p>(%{</span><span class=ss>from</span><span class=p>:</span> <span class=n>from</span><span class=p>,</span> <span class=ss>to</span><span class=p>:</span> <span class=n>to</span><span class=p>})</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>cond</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>      <span class=n>to</span> <span class=o>&gt;=</span> <span class=mi>2</span> <span class=ow>and</span> <span class=n>to</span> <span class=o>&gt;=</span> <span class=n>from</span> <span class=o>-&gt;</span> <span class=p>{</span><span class=ss>:ok</span><span class=p>,</span> <span class=n>sieve</span><span class=p>(</span><span class=n>from</span><span class=p>,</span> <span class=n>to</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>      <span class=n>to</span> <span class=o>&lt;</span> <span class=n>from</span> <span class=o>-&gt;</span> <span class=n>error</span><span class=p>(</span><span class=s2>&#34;Your upper bound is less than the lower bound.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>to</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=o>-&gt;</span> <span class=n>error</span><span class=p>(</span><span class=s2>&#34;There are no primes less than 2.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=no>true</span> <span class=o>-&gt;</span> <span class=n>error</span><span class=p>(</span><span class=s2>&#34;Uncaught error. Check your input.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>def</span> <span class=n>get</span><span class=p>(%{</span><span class=ss>to</span><span class=p>:</span> <span class=n>_to</span><span class=p>}</span> <span class=o>=</span> <span class=n>arg</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>get</span><span class=p>(</span><span class=nc>Map</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>arg</span><span class=p>,</span> <span class=ss>:from</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>def</span> <span class=n>get</span><span class=p>(%{</span><span class=ss>from</span><span class=p>:</span> <span class=n>_from</span><span class=p>})</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>error</span><span class=p>(</span><span class=sx>~S(No &#34;to:&#34; value provided.)</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>defp</span> <span class=n>sieve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>when</span> <span class=n>is_number</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=ow>and</span> <span class=n>is_number</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nc>Enum</span><span class=o>.</span><span class=n>to_list</span><span class=p>(</span><span class=mi>2</span><span class=o>..</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=n>sieve</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=nc>Enum</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=o>|&gt;</span> <span class=n>show_primes_in_range</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>defp</span> <span class=n>sieve</span><span class=p>([</span><span class=n>n</span> <span class=o>|</span> <span class=n>ns</span><span class=p>],</span> <span class=n>acc</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>sieve</span><span class=p>(</span><span class=nc>Enum</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>ns</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=k>fn</span> <span class=n>x</span> <span class=o>-&gt;</span> <span class=n>rem</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span> <span class=k>end</span><span class=p>),</span> <span class=p>[</span><span class=n>n</span> <span class=o>|</span> <span class=n>acc</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>defp</span> <span class=n>sieve</span><span class=p>([],</span> <span class=n>acc</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=n>acc</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>defp</span> <span class=n>show_primes_in_range</span><span class=p>([</span><span class=n>p</span> <span class=o>|</span> <span class=n>ps</span><span class=p>]</span> <span class=o>=</span> <span class=n>primes</span><span class=p>,</span> <span class=n>lower_bound</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>cond</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>      <span class=n>lower_bound</span> <span class=o>==</span> <span class=mi>2</span> <span class=o>-&gt;</span> <span class=n>primes</span>
</span></span><span class=line><span class=cl>      <span class=n>p</span> <span class=o>&gt;=</span> <span class=n>lower_bound</span> <span class=o>-&gt;</span> <span class=n>primes</span>
</span></span><span class=line><span class=cl>      <span class=no>true</span> <span class=o>-&gt;</span> <span class=n>show_primes_in_range</span><span class=p>(</span><span class=n>ps</span><span class=p>,</span> <span class=n>lower_bound</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>defp</span> <span class=n>error</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=ss>:error</span><span class=p>,</span> <span class=n>msg</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></div></div><div class=post__footer><span><a class=tag href=/tags/elixir/>elixir</a><a class=tag href=/tags/algorithms/>algorithms</a></span></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
2022</li><li class=footer__item><a class=link href=/imprint/ title>imprint</a></li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.a3fd0638ada4e3cec287e49a604b4a828cfef33a669afe60b96575761fff5cf3.js integrity="sha256-o/0GOK2k487Ch+SaYEtKgoz+8zpmmv5guWV1dh//XPM=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css integrity=sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js integrity=sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js integrity=sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v crossorigin=anonymous onload=renderMathInElement(document.body)></script></body></html>